<!DOCTYPE html>
<html>
  <head>
    <title>Detecting the unexpected in (Web) UI</title>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../shared/reveal.min.css">
    <link rel="stylesheet" href="../shared/black.css">
    <link rel="stylesheet" href="../shared/zenburn.css" id="highlight-css">
    <style>
.reveal h1, .reveal h2, .reveal h3, .reveal h4, .reveal h5, .reveal h6 {
    font-weight: normal;
    text-transform: none; 
}

.reveal h1 + .more, .reveal h2 + .more, .reveal h3 + .more, .reveal h4 + .more, .reveal h5 + .more, .reveal h6 + .more {
    margin-top: -20px;
}

.reveal .more {
    color: #777872;
}

.reveal a, h3 {
    color: #ffc404 !important;
    text-decoration: none;
}
.reveal a:hover, h2 {
    color: #f37723 !important;
    text-decoration: none;
}

.reveal blockquote, .reveal p.quote {
    margin: 0;
    text-align: justify;
    font-style: italic;
    margin-right: 1em;
    margin-top: 20px;
    margin-bottom: 20px;
    padding-left: 1em;
    font-size: 0.9em;
    border-left: 1px navajowhite solid;
}
.reveal blockquote::before, .reveal p.quote::before {
    content: '\201C';
    font-size: 2em;
    float: left;
    color: white;
    margin-left: -1em;
}

.reveal p.quote-right {
    margin: 0;
    text-align: right;
    font-style: italic;
    margin-left: 1em;
    margin-top: 20px;
    margin-bottom: 20px;
    padding-right: 1em;
    font-size: 0.9em;
    border-right: 1px navajowhite solid;
}
.reveal p.quote-right::after {
    content: '\201C';
    font-size: 2em;
    float: right;
    color: white;
    margin-right: -1em;
}

em {
    color: #f37723;
    font-style: normal;
    font-weight: normal;
}

li {
    color: #d3d3d3;
}

li.active, .left-menu > li:last-child, .left-menu > li:last-child > ul > li:last-child {
    color: #f37723;
}

.reveal ol {
    counter-reset: step-counter;
    list-style-type: none;
    margin: 0;
    padding: 0;
    width: 100%;
    text-align: center;
}

.reveal ol li {
    counter-increment: step-counter;
    margin-top: 10px;
    margin-bottom: 10px;
}

.reveal ol li:before {
    content: counter(step-counter, upper-roman);
    color: #f37723;
    float: left;
}

.reveal .vsmallnote {
    font-style: italic;
    font-size: 0.5em;
    color: #777872;
}

.flex {
    display: flex;
    flex-flow: row;
}

.no-margin {
    margin: none !important;
}

.left-column, .right-column {
    flex: 50%;
    text-align: left;
}

.left-padded {
    padding-left: 1em !important;
}

        </style>
  </head>
  <body>
    <div class="reveal">
        <div class="slides">
            <section>
                <section>
                    <h1>Detecting the unexpected</h1>
                    <h2>Let's fuzz UI</h2>
                </section>
                <section>
                	<div>
                		<img src="./images/me.jpg" style="border-radius:50%;height:128px;" />
                	</div>
                	<div>
	                	<h2>Nicolas DUBIEN</h2>
	                	<div style="margin-top:48px;"></div>
	                	<div style="border-bottom-style: dashed;border-bottom-color: #ffffff;border-bottom-width: 1px;">
	                		<div style="float:left;">2014 - 2017</div>
	                		<div style="float:right;">C++ at Murex</div>
	                		&nbsp;
	                	</div>
	                	<div>
	                		<div style="float:left;">2017 -     </div>
	                		<div style="float:right;">TypeScript and C# at Criteo</div>
	                		&nbsp;
	                	</div>
	                	<div style="margin-top:48px;"></div>
	                	<div style="color:#ffffff;vertical-align:middle;">
	                		<img src="./images/github-white.png" style="height:32px;border:none;background:none;margin:0px;">
	                		dubzzz
	                	</div>
	                	<div style="color:#1da1f2;vertical-align:middle;">
	                		<img src="./images/twitter.png" style="height:32px;border:none;background:none;margin:0px;">
	                		ndubien
	                	</div>
                	</div>
                </section>
                <section style="display:flex;flex-direction:row;justify-content:space-evenly;">
                	<div style="display:inline-block;margin:10px;width:270px;">
                		<img src="./images/part-a.jpg" style="border-radius:50%;height:128px;" />
                		<h3>Unexpected</h3>
                		<p class="vsmallnote">Strange scenario</p>
                	</div>
                	<div style="display:inline-block;margin:10px;width:270px;">
                		<img src="./images/part-c.jpg" style="border-radius:50%;height:128px;" />
                		<h3>Detection</h3>
                		<p class="vsmallnote">From human to machine</p>
                	</div>
                	<div style="display:inline-block;margin:10px;width:270px;">
                		<img src="./images/part-d.jpg" style="border-radius:50%;height:128px;" />
                		<h3>Implem</h3>
                		<p class="vsmallnote">Going live</p>
                	</div>
                </section>
            </section>
            <section>
                <section>
                    <div>
                        <img src="./images/part-a.jpg" style="border-radius:50%;height:128px;" />
                        <h3>Unexpected</h3>
                        <p class="vsmallnote">Strange scenario</p>
                    </div>
                </section>
                <section>
                    <h2>And then one day, it happened...</h2>
                </section>
                <section>
                    <p class="quote">
                        [â€¦] Steps to reproduce the bug:
                        <br/>
                        <br/>1- Start a new project
                        <br/>2- Save it
                        <br/>3- Refresh the page
                        <br/>4- Click on â€˜go back homeâ€™ ğŸ’¥
                    </p>
                </section>
                <section>
                    <h2>You're not the only one...</h2>
                </section>
                <section>
                    <h3>Android: bypass the lock screen</h3>
                    <p class="quote">
                        1- Lock your screen
                        <br/>2- Open the EMERGENCY CALL window
                        <br/>3- Type a few characters
                        <br/>4- Select them and copy-paste <i>until no longer highlights</i>
                        <br/>5- Go back to the lockscreen
                        <br/>6- Open the camera
                        <br/>7- Open the notification drawer
                        <br/>8- Tap the Settings (gear) icon
                        <br/>9- Long-tap in the password field and paste the characters into it <i>until it crashes</i>
                    </p>
                </section>
                <section>
                    <h2>And many others...</h2>
                    <h3>GitHub, Spotify, LevelDB, Jira...</h3>
                </section>
            </section>
            <section>
                <section>
                    <div>
                        <img src="./images/part-c.jpg" style="border-radius:50%;height:128px;" />
                        <h3>Detection</h3>
                        <p class="vsmallnote">From human to machine</p>
                    </div>
                </section>
                <section>
                    <h2>Hard to catch ğŸ˜±</h2>
                    <h3 class="fragment">But possible...</h3>
                </section>
                <section>
                    <img src="images/part-b.png" />
                </section>
                <section>
                    <h2>Play randomly with the UI</h2>
                </section>
                <section>
                    <h3>Infinite monkey theorem</h3>
                    <p class="quote">
                        a monkey hitting keys at random on a typewriter keyboard
                        for an infinite amount of time will almost surely type any given text,
                        such as the complete works of William Shakespeare
                    </p>
                </section>
                <section>
                    <h3>Process</h3>
                    <p class="fragment">ğŸ’ apply operations ğŸ’</p>
                    <p class="fragment">ğŸ’ but only when possible ğŸ’</p>
                    <p class="fragment">ğŸ’ and check it worked as expected ğŸ’</p>
                    <p class="fragment">ğŸ” try again ğŸ”</p>
                </section>
                <section>
                    <h2>Towards automation...</h2>
                </section>
                <section>
                    <h3>Test scenario</h3>
                    <p class="fragment">ğŸ’ succession of valid actions ğŸ’</p>
                    <p class="fragment">ğŸ’ check it did what it was supposed to do ğŸ’</p>
                </section>
                <section>
                    <h3>Command</h3>
                    <div class="fragment">
                        <p>ğŸ’ pre-condition ğŸ’</p>
                        <p class="vsmallnote">can the command be executed given the current context?</p>
                    </div>
                    <div class="fragment">
                        <p>ğŸ’ action ğŸ’</p>
                        <p class="vsmallnote">what is the command supposed to do?</p>
                    </div>
                    <div class="fragment">
                        <p>ğŸ’ post-condition ğŸ’</p>
                        <p class="vsmallnote">what are the expected outcomes of the command visible?</p>
                    </div>
                </section>
                <section>
                    <p>
                        Given that we defined <em>all the possible commands</em> for our system,
                        we are able to generate our own random <em>scenario</em>.
                        In order to do so, we <em>generate a random array</em> of commands,
                        we take them one by one and we execute them in order.
                    </p>
                </section>
                <section>
                    <img src="images/scenario.png" />
                </section>
            </section>
            <section>
                <section>
                    <div>
                        <img src="./images/part-d.jpg" style="border-radius:50%;height:128px;" />
                        <h3>Implem</h3>
                		<p class="vsmallnote">Going live</p>
                    </div>
                </section>
                <section>
                    <h2>Wait a minute... ğŸ˜“</h2>
                    <h3 class="fragment">Random?</h3>
                    <h3 class="fragment">Large arrays?</h3>
                </section>
                <section>
                    <h3>Just imagine this scenario:</h3>
                    <p class="quote">
                        0- (Not a command) Open the game
                        <br/>1- Click on â€œnew gameâ€
                        <br/>2- Bookmark the url
                        <br/>3- Open bookmarked url: http://localhost:3000/#/
                        <br/>4- Press F5 to refresh the page
                        <br/>5- Bookmark the url
                        <br/>6- Play token in the 2nd column
                        <br/>7- Click on â€œnew gameâ€
                        <br/>8- Play token in the 2nd column
                        <br/>[...]
                        <br/>24- Bookmark the url
                        <br/>25- Click on â€œnew gameâ€
                        <br/>26- Press F5 to refresh the page
                        <br/>27- Bookmark the url ğŸ’¥
                    </p>
                </section>
                <section>
                    <h2>Property based to the rescue ğŸ¯</h2>
                    <h3 class="fragment">Generate random data</h3>
                    <h3 class="fragment">Shrink in case of failure</h3>
                    <p class="fragment">
                        We will use
                        <img src="./images/github-white.png" style="height:32px;border:none;background:none;margin:0px;">fast-check
                    </p>
                </section>
                <section>
                    <iframe id="game-iframe" src="https://dubzzz.github.io/connect-four-react/bug/" height="600" width="600"></iframe>
                    <!--<iframe id="game-iframe" src="http://localhost:3000/" height="600" width="600"></iframe>-->
                </section>
                <section>
                    <h2>User capabilities</h2>
                </section>
                <section>
                    <p>ğŸ’ click on grid ğŸ’</p>
                    <p>ğŸ’ click on buttons ğŸ’</p>
                    <p>ğŸ’ re-use bookmarked url ğŸ’</p>
                </section>
                <section>
                    <h2>Commands</h2>
                </section>
                <section>
                    <p>ğŸ’ play a valid move ğŸ’</p>
                    <p>ğŸ’ undo a move ğŸ’</p>
                    <p>ğŸ’ redo a move ğŸ’</p>
                    <p>ğŸ’ restart the game ğŸ’</p>
                    <p>ğŸ’ bookmark a url ğŸ’</p>
                    <p>ğŸ’ open a previously bookmarked url ğŸ’</p>
                </section>
                <section>
                    <h3>Play a valid move</h3>
                    <div class="fragment">
                        <p>ğŸ’ pre-condition ğŸ’</p>
                        <p class="vsmallnote">no winner yet, column is not fullâ€Šâ€”â€Šor the column is clickable</p>
                    </div>
                    <div class="fragment">
                        <p>ğŸ’ action ğŸ’</p>
                        <p class="vsmallnote">click on the column</p>
                    </div>
                    <div class="fragment">
                        <p>ğŸ’ post-condition ğŸ’</p>
                        <p class="vsmallnote">a new token has been added into the column with the color of the current player</p>
                    </div>
                </section>
                <section>
                    <img src="./images/code-ctor.png" />
                </section>
                <section>
                    <img src="./images/code-check.png" />
                </section>
                <section>
                    <img src="./images/code-run.png" />
                </section>
                <section>
                    <img src="./images/code-fc.png" />
                </section>
                <section>
                    <h2>Ready?</h2>
                </section>
                <section>
                    <img src="./images/property-based.gif" />
                </section>
                <section>
                    <h3>It found:</h3>
                    <p class="quote">
                        0- (Not a command) Open the game
                        <br/>1- Click on â€œnew gameâ€
                        <br/>2- Bookmark the url
                        <br/>3- Open bookmarked url: http://localhost:3000/#/
                        <br/>4- Press F5 to refresh the page
                        <br/>5- Bookmark the url
                        <br/>6- Play token in the 2nd column
                        <br/>7- Click on â€œnew gameâ€
                        <br/>8- Play token in the 2nd column
                        <br/>[...]
                        <br/>24- Bookmark the url
                        <br/>25- Click on â€œnew gameâ€
                        <br/>26- Press F5 to refresh the page
                        <br/>27- Bookmark the url ğŸ’¥
                    </p>
                </section>
                <section>
                    <h3>It reported:</h3>
                    <p class="quote">
                        0- (Not a command) Open the game
                        <br/>1- Bookmark the urlâ€Šâ€”â€Šempty grid and 1 has to play
                        <br/>2- Play token in the 6th column
                        <br/>3- Click on â€œnew gameâ€
                        <br/>4- Bookmark the urlâ€Šâ€”â€Šempty grid and 2 has to play ğŸ’¥
                    </p>
                </section>
                <section>
                    <h2>Applied at Criteo?</h2>
                    <h3 class="fragment">Yes and No</h3>
                </section>
            </section>
            <section>
            	<section>
            		<h2>Questions?</h2>
                	<div style="margin-top:48px;"></div>
                	<div style="color:#ffffff;vertical-align:middle;">
                		<img src="./images/github-white.png" style="height:32px;border:none;background:none;margin:0px;">
                		dubzzz
                	</div>
                	<div style="color:#1da1f2;vertical-align:middle;">
                		<img src="./images/twitter.png" style="height:32px;border:none;background:none;margin:0px;">
                		ndubien
                	</div>
                	<div style="margin-top:48px;"></div>
                	<div style="color:#ffffff;vertical-align:middle;">
                		<img src="./images/fast-check-ui.png" style="border:none;background:none;margin:0px;">
                	</div>
            	</section>
            </section>
        </div>
    </div>
    <div style="position:fixed;z-index:9999;left:1em;bottom:1em;color:#ffffff;font-size:1.5em;">
    	<div style="color:#ffffff;vertical-align:middle;">
    		<img src="./images/github-white.png" style="height:16px;border:none;background:none;margin:0px;">
    		dubzzz
    	</div>
    	<div style="color:#1da1f2;vertical-align:middle;">
    		<img src="./images/twitter.png" style="height:16px;border:none;background:none;margin:0px;">
    		ndubien
    	</div>
    </div>
    <script src="../shared/head.min.js"></script>
    <script src="../shared/reveal.min.js"></script>
    <script>
    Reveal.initialize({
    // Display controls in the bottom right corner
    controls: true,

    // Display a presentation progress bar
    progress: true,

    // Set default timing of 2 minutes per slide
    defaultTiming: 120,

    // Display the page number of the current slide
    slideNumber: false,

    // Push each slide change to the browser history
    history: false,

    // Enable keyboard shortcuts for navigation
    keyboard: true,

    // Enable the slide overview mode
    overview: true,

    // Vertical centering of slides
    center: true,

    // Enables touch navigation on devices with touch input
    touch: true,

    // Loop the presentation
    loop: false,

    // Change the presentation direction to be RTL
    rtl: false,

    // Randomizes the order of slides each time the presentation loads
    shuffle: false,

    // Turns fragments on and off globally
    fragments: true,

    // Flags if the presentation is running in an embedded mode,
    // i.e. contained within a limited portion of the screen
    embedded: false,

    // Flags if we should show a help overlay when the questionmark
    // key is pressed
    help: true,

    // Flags if speaker notes should be visible to all viewers
    showNotes: false,

    // Global override for autolaying embedded media (video/audio/iframe)
    // - null: Media will only autoplay if data-autoplay is present
    // - true: All media will autoplay, regardless of individual setting
    // - false: No media will autoplay, regardless of individual setting
    autoPlayMedia: null,

    // Number of milliseconds between automatically proceeding to the
    // next slide, disabled when set to 0, this value can be overwritten
    // by using a data-autoslide attribute on your slides
    autoSlide: 0,

    // Stop auto-sliding after user input
    autoSlideStoppable: true,

    // Use this method for navigation when auto-sliding
    autoSlideMethod: Reveal.navigateNext,

    // Enable slide navigation via mouse wheel
    mouseWheel: false,

    // Hides the address bar on mobile devices
    hideAddressBar: true,

    // Opens links in an iframe preview overlay
    previewLinks: false,

    // Transition style
    transition: 'slide', // none/fade/slide/convex/concave/zoom

    // Transition speed
    transitionSpeed: 'default', // default/fast/slow

    // Transition style for full page slide backgrounds
    backgroundTransition: 'fade', // none/fade/slide/convex/concave/zoom

    // Number of slides away from the current that are visible
    viewDistance: 3,

    // Parallax background image
    parallaxBackgroundImage: '', // e.g. "'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg'"

    // Parallax background size
    parallaxBackgroundSize: '', // CSS syntax, e.g. "2100px 900px"

    // Number of pixels to move the parallax background per slide
    // - Calculated automatically unless specified
    // - Set to 0 to disable movement along an axis
    parallaxBackgroundHorizontal: null,
    parallaxBackgroundVertical: null,

    // The display mode that will be used to show slides
    display: 'block',

    // Add timer coming from project: https://github.com/tkrkt/reveal.js-elapsed-time-bar
    allottedTime: 20 * 60 * 1000,
    keyboard: { 82 /*r*/: () => { ElapsedTimeBar.reset(); } },

    // Optional modules
    dependencies: [
        { src: '../shared/elapsed-time-bar.js' },
        { src: '../shared/classList.js', condition: function() { return !document.body.classList; } },
        { src: '../shared/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: '../shared/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: '../shared/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
        { src: '../shared/zoom.js', async: true },
    ]
});
// Taken from https://developer.mozilla.org/en-US/docs/Web/Events/wheel
// creates a global "addWheelListener" method
// example: addWheelListener( elem, function( e ) { console.log( e.deltaY ); e.preventDefault(); } );
(function(window,document) {
    
    var prefix = "", _addEventListener, support;

    // detect event model
    if ( window.addEventListener ) {
        _addEventListener = "addEventListener";
    } else {
        _addEventListener = "attachEvent";
        prefix = "on";
    }

    // detect available wheel event
    support = "onwheel" in document.createElement("div") ? "wheel" : // Modern browsers support "wheel"
                document.onmousewheel !== undefined ? "mousewheel" : // Webkit and IE support at least "mousewheel"
                "DOMMouseScroll"; // let's assume that remaining browsers are older Firefox

    window.addWheelListener = function( elem, callback, useCapture ) {
        _addWheelListener( elem, support, callback, useCapture );

        // handle MozMousePixelScroll in older Firefox
        if( support == "DOMMouseScroll" ) {
            _addWheelListener( elem, "MozMousePixelScroll", callback, useCapture );
        }
    };

    function _addWheelListener( elem, eventName, callback, useCapture ) {
        elem[ _addEventListener ]( prefix + eventName, support == "wheel" ? callback : function( originalEvent ) {
            !originalEvent && ( originalEvent = window.event );

            // create a normalized event object
            var event = {
                // keep a ref to the original event object
                originalEvent: originalEvent,
                target: originalEvent.target || originalEvent.srcElement,
                type: "wheel",
                deltaMode: originalEvent.type == "MozMousePixelScroll" ? 0 : 1,
                deltaX: 0,
                deltaY: 0,
                deltaZ: 0,
                preventDefault: function() {
                    originalEvent.preventDefault ?
                        originalEvent.preventDefault() :
                        originalEvent.returnValue = false;
                }
            };
            
            // calculate deltaY (and deltaX) according to the event
            if ( support == "mousewheel" ) {
                event.deltaY = - 1/40 * originalEvent.wheelDelta;
                // Webkit also support wheelDeltaX
                originalEvent.wheelDeltaX && ( event.deltaX = - 1/40 * originalEvent.wheelDeltaX );
            } else {
                event.deltaY = originalEvent.deltaY || originalEvent.detail;
            }

            // it's time to fire the callback
            return callback( event );

        }, useCapture || false );
    }

})(window,document);

window.addWheelListener(document, function(event) {
    console.log(JSON.stringify(event.deltaY));
    if (event.deltaY > 0) {
        document.dispatchEvent(new KeyboardEvent('keydown', {'keyCode': 32,'which': 32}));
    }
    else if (event.deltaY < 0) {
        document.dispatchEvent(new KeyboardEvent('keydown', {'keyCode': 33,'which': 33}));
    }
});
    </script>
  </body>
</html>
