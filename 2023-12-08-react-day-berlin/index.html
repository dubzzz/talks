<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

    <title>Break the Race: Easy Race Condition Detection for React</title>

    <link rel="stylesheet" href="css/reset.css" />
    <link rel="stylesheet" href="css/reveal.css" />
    <link rel="stylesheet" href="css/theme/black.css" />

    <!-- Theme used for syntax highlighting of code -->
    <link rel="stylesheet" href="lib/css/monokai.css" />

    <style>
      .styleless-image {
        border: none !important;
        background: none !important;
        margin: 0px !important;
      }

      @font-face {
        font-family: MonospaceArgon;
        src: url(../fonts/MonaspaceArgon-Regular.woff);
      }
      @font-face {
        font-family: MonospaceKrypton;
        src: url(../fonts/MonaspaceKrypton-Regular.woff);
      }
      @font-face {
        font-family: MonospaceNeon;
        src: url(../fonts/MonaspaceNeon-Regular.woff);
      }
      @font-face {
        font-family: MonospaceRadon;
        src: url(../fonts/MonaspaceRadon-Regular.woff);
      }
      @font-face {
        font-family: MonospaceXenon;
        src: url(../fonts/MonaspaceXenon-Regular.woff);
      }

      .reveal .controls {
        color: #0d0175;
      }

      .reveal {
        font-size: 36px;
      }

      .reveal pre {
        box-shadow: none;
      }

      .reveal pre code {
        background: none;
      }

      .reveal h1,
      .reveal h2,
      .reveal h3,
      .reveal h4,
      .reveal h5,
      .reveal h6 {
        font-family: MonospaceKrypton;
        font-weight: normal;
        text-transform: none;
      }

      .reveal h1 + .more,
      .reveal h2 + .more,
      .reveal h3 + .more,
      .reveal h4 + .more,
      .reveal h5 + .more,
      .reveal h6 + .more {
        margin-top: -20px;
      }

      .reveal .more {
        color: #777872;
      }

      .reveal a,
      h3 {
        color: #f8ff17 !important;
        text-decoration: none;
      }
      .reveal a:hover,
      h2 {
        color: #17ff2e !important;
        text-decoration: none;
      }

      .reveal blockquote,
      .reveal p.quote {
        margin: 0;
        text-align: justify;
        font-style: italic;
        margin-right: 1em;
        margin-top: 20px;
        margin-bottom: 20px;
        padding-left: 1em;
        font-size: 0.9em;
        border-left: 1px navajowhite solid;
      }
      .reveal blockquote::before,
      .reveal p.quote::before {
        content: '\201C';
        font-size: 2em;
        float: left;
        color: white;
        margin-left: -1em;
      }

      .reveal p.quote-right {
        margin: 0;
        text-align: right;
        font-style: italic;
        margin-left: 1em;
        margin-top: 20px;
        margin-bottom: 20px;
        padding-right: 1em;
        font-size: 0.9em;
        border-right: 1px navajowhite solid;
      }
      .reveal p.quote-right::after {
        content: '\201C';
        font-size: 2em;
        float: right;
        color: white;
        margin-right: -1em;
      }

      em {
        color: #f8ff17;
        font-style: normal;
        font-weight: normal;
      }

      li {
        color: #d3d3d3;
      }

      li.active,
      .left-menu > li:last-child,
      .left-menu > li:last-child > ul > li:last-child {
        color: #f37723;
      }

      .reveal ol {
        counter-reset: step-counter;
        list-style-type: none;
        margin: 0;
        padding: 0;
        width: 100%;
        text-align: center;
      }

      .reveal ol li {
        counter-increment: step-counter;
        margin-top: 10px;
        margin-bottom: 10px;
      }

      .reveal ol li:before {
        content: counter(step-counter, upper-roman);
        color: #f37723;
        float: left;
      }

      .reveal .vsmallnote {
        font-family: MonospaceKrypton;
        font-style: italic;
        font-size: 0.5em;
        color: #777872;
      }

      .flex {
        display: flex;
        flex-flow: row;
      }

      .no-margin {
        margin: none !important;
      }

      .left-column,
      .right-column {
        flex: 50%;
        text-align: left;
      }

      .left-padded {
        padding-left: 1em !important;
      }

      body {
        background: #230cea;
        background-color: #230cea;
      }

      .custom-collapse.fragment {
        max-height: 0;
        transform: scaleY(0%);
      }
      .custom-collapse.fragment.visible {
        max-height: 100px;
        transform: scaleY(100%);
        transition: max-height 2s ease-in, transform 2s ease-in;
      }

      .reveal .slides section .fragment.highlight-transparent {
        opacity: 1;
        visibility: visible;
      }
      .reveal .slides section .fragment.highlight-transparent.visible {
        opacity: 0.2;
        transition: opacity 0.3s ease-in;
      }

      .reveal .slides section.fullScreen {
        top: unset;
        padding: unset;
      }
      .reveal .slides section.fullScreen code {
        max-height: unset;
        max-width: unset;
      }

      /* It seems that there is a syntax highlighting bug when using data-line-numbers */
      section code[data-line-numbers]:not([data-fragment-index]),
      section code[data-line-numbers][data-fragment-index]:not(.current-fragment) {
        opacity: 0 !important;
        transition: all 0.2s ease-in;
      }
      section[data-fragment='-1'] code[data-line-numbers]:not([data-fragment-index]),
      section code[data-line-numbers][data-fragment-index].current-fragment {
        opacity: 1 !important;
        transition: all 0.2s ease-out;
      }

      @font-face {
        font-family: 'Virgil';
        src: url('./lib/font/FG_Virgil.woff2');
        /* src: url('https://excalidraw.com/FG_Virgil.woff2'); */
      }
      g.diag-white path,
      g.diag-user path,
      g.diag-call path,
      g.diag-answer path {
        stroke-width: 4px;
        fill: none;
      }
      g.diag-white text,
      g.diag-user text,
      g.diag-call text,
      g.diag-answer text {
        font-family: 'Virgil';
        font-size: 26px;
      }
      g.diag-white path {
        stroke: #ffffff;
      }
      g.diag-white text {
        fill: #ffffff;
      }
      g.diag-user path {
        stroke: #17c9ff;
      }
      g.diag-user text {
        fill: #17c9ff;
      }
      g.diag-call path {
        stroke: #ccf0fc;
      }
      g.diag-call text {
        fill: #ccf0fc;
      }
      g.diag-answer path {
        stroke: #17ff2e;
      }
      g.diag-answer text {
        fill: #17ff2e;
      }

      .slide-number {
        background-color: inherit !important;
      }
      .footer-github {
        filter: invert(0);
        transition: all 0.2s ease;
      }
      .has-light-background + div .footer-github {
        filter: invert(0.7);
      }
      .current-fragment.animate-arrow {
        animation-duration: 1000ms;
        animation-iteration-count: 1;
        animation-name: animation-arrow;
      }
      @keyframes animation-arrow {
        0% {
          transform-origin: top;
          transform: scaleY(0);
          opacity: 0;
        }
        100% {
          transform-origin: top;
          transform: scaleY(100%);
          opacity: 1;
        }
      }
      .current-fragment.animate-arrow-bottom {
        animation-duration: 1000ms;
        animation-iteration-count: 1;
        animation-name: animation-arrow-bottom;
      }
      @keyframes animation-arrow-bottom {
        0% {
          transform-origin: bottom;
          transform: scaleY(0);
          opacity: 0;
        }
        100% {
          transform-origin: bottom;
          transform: scaleY(100%);
          opacity: 1;
        }
      }
    </style>

    <!-- Printing and PDF exports -->
    <script>
      var link = document.createElement('link');
      link.rel = 'stylesheet';
      link.type = 'text/css';
      link.href = window.location.search.match(/print-pdf/gi) ? 'css/print/pdf.css' : 'css/print/paper.css';
      document.getElementsByTagName('head')[0].appendChild(link);
    </script>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">
        <section
          data-state="bsod-slide-before"
          data-background-image="images/conf-splash-logo.png"
          data-background-position="bottom center"
          data-background-size="80%"
          data-transition="none"
          data-background-transition="none"
        >
          <h1 style="margin-bottom: -16px; margin-top: -140px">Break the Race</h1>
          <h2
            style="
              color: #040024 !important;
              margin-bottom: 200px;
              font-size: 1em;
              font-family: MonospaceRadon !important;
            "
          >
            Easy Race Condition Detection for React
          </h2>
          <h3 style="color: #230cea !important; text-shadow: -1px 0 #fffa, 0 1px #fffa, 1px 0 #fffa, 0 -1px #fffa">
            Nicolas DUBIEN
          </h3>
        </section>
        <section
          data-state="bsod-slide"
          data-background-image="images/bsod.gif"
          data-background-size="100% 100%"
          data-transition="none"
          data-background-transition="none"
        ></section>
        <section>
          <img id="navigation-hell" alt="Navigation hell" src="./images/navigation-hell.gif" onclick="resetGif()" />
          <script>
            function resetGif() {
              document.getElementById('navigation-hell').setAttribute('src', '');
              document.getElementById('navigation-hell').setAttribute('src', './images/navigation-hell.gif');
            }
          </script>
        </section>
        <section>
          <h1>Let's talk about race conditions</h1>
        </section>
        <section>
          <div>
            <img src="./images/me.jpg" style="border-radius: 50%; height: 128px" />
          </div>
          <div>
            <h1>Nicolas DUBIEN</h1>
            <div
              style="display: flex; align-items: center; justify-content: center; font-size: 0.8em; margin-top: -20px"
            >
              Software Engineer at
              <img
                src="./images/pigment-logofull-white.png"
                class="styleless-image"
                style="height: 50px; box-shadow: none"
              />
            </div>
            <div style="margin-top: 48px"></div>
            <div style="color: #ffffff; vertical-align: middle; font-family: MonospaceKrypton">
              <img src="./images/github-white.png" style="height: 32px; border: none; background: none; margin: 0px" />
              dubzzz
            </div>
            <div style="color: #4293db; vertical-align: middle; font-family: MonospaceKrypton">
              <img
                src="./images/Mastodon_Logotype_(Simple).svg.png"
                style="height: 32px; border: none; background: none; margin: 0px"
              />
              ndubien
            </div>
            <div style="color: #cb3837; vertical-align: middle; font-family: MonospaceKrypton">
              <img src="./images/npm.png" style="height: 32px; border: none; background: none; margin: 0px" />
              fast-check
            </div>
          </div>
        </section>
        <section>
          <h2>Race condition?</h2>
          <p class="quote">
            <span class="fragment highlight-transparent visible" data-fragment-index="1"
              >A race condition […] is the condition […] where the system's substantive behavior is dependent on the </span
            ><span class="fragment highlight-green visible" data-fragment-index="1">sequence</span
            ><span class="fragment highlight-transparent visible" data-fragment-index="1"> or timing </span
            ><span class="fragment highlight-green visible" data-fragment-index="1">of</span
            ><span class="fragment highlight-transparent visible" data-fragment-index="1"> other </span
            ><span class="fragment highlight-green visible" data-fragment-index="1">uncontrollable events</span
            ><span class="fragment highlight-transparent visible" data-fragment-index="1">.</span>
          </p>
          <p class="fragment custom-collapse">🤔 What about user inputs, API calls…?</p>
          <p class="vsmallnote">
            Source:
            <a href="https://en.wikipedia.org/wiki/Race_condition" target="_blank"
              >https://en.wikipedia.org/wiki/Race_condition</a
            >
          </p>
        </section>
        <section>
          <style>
            .current-fragment.animate-paris-stays-user text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-paris-stays-user;
            }
            @keyframes animation-paris-stays-user {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(35px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(35px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-paris-stays-query text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-paris-stays-query;
            }
            @keyframes animation-paris-stays-query {
              0% {
                transform: rotate(90deg) scale(2) translateY(-215px) translateX(40px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-215px) translateX(40px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-paris-stays-answer text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-paris-stays-answer;
            }
            @keyframes animation-paris-stays-answer {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-30px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-30px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-london-stays-user text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-london-stays-user;
            }
            @keyframes animation-london-stays-user {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-150px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-150px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-london-stays-query text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-london-stays-query;
            }
            @keyframes animation-london-stays-query {
              0% {
                transform: rotate(90deg) scale(2) translateY(-210px) translateX(-150px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-210px) translateX(-150px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-london-stays-answer text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-london-stays-answer;
            }
            @keyframes animation-london-stays-answer {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-215px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-215px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
          </style>
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 926 520">
            <g class="diag-white">
              <g transform="translate(10 436) rotate(0 453 0)">
                <path d="M1 -2 C152 -2, 754 -1, 905 -0 M1 2 C152 3, 752 1, 904 1" />
                <path d="M872 9 C881 11, 895 1, 901 2 M876 12 C885 7, 894 5, 902 1" />
                <path d="M872 -11 C880 -2, 895 -5, 901 2 M876 -7 C885 -5, 894 -0, 902 1" />
              </g>
            </g>
            <g class="diag-white" transform="translate(844 466) rotate(0 34 22)">
              <text x="0" y="32">Time</text>
            </g>
            <g class="diag-user fragment animate-arrow" data-fragment-index="1">
              <g transform="translate(60 265) rotate(0 0 80)">
                <path d="M-1 -1 C-0 25, -0 134, -0 162 M0 -0 C-0 26, 2 133, 1 160" />
                <path d="M-10 133 C-9 138, -1 147, -1 160 M-9 130 C-3 139, -1 147, -0 159" />
                <path d="M10 133 C6 138, 10 147, -1 160 M11 130 C10 138, 6 146, -0 159" />
              </g>
            </g>
            <g
              class="diag-user fragment animate-paris-stays-user"
              data-fragment-index="1"
              transform="translate(-118 217) rotate(270 150 22)"
            >
              <text x="0" y="32">User looks for stays in Paris</text>
            </g>
            <g class="diag-call fragment animate-arrow-bottom" data-fragment-index="2">
              <g transform="translate(83 426.148936170213) rotate(0 -1 -39)">
                <path d="M-1 -0 C-2 -13, -0 -62, -0 -74 M-2 -2 C-3 -15, 0 -64, 0 -77" />
                <path d="M7 -50 C6 -60, 2 -70, 2 -80 M8 -50 C6 -56, 6 -60, 1 -76" />
                <path d="M-12 -51 C-5 -61, -1 -70.551366474985, 2 -80 M-11 -51 C-8 -56, -3 -61, 1 -76" />
              </g>
            </g>
            <g
              class="diag-call fragment animate-paris-stays-query"
              data-fragment-index="2"
              transform="translate(-28 261) rotate(270 136.5 22)"
            >
              <text x="0" y="32">API call for Paris</text>
            </g>
            <g
              class="diag-call fragment animate-paris-stays-query"
              data-fragment-index="2"
              transform="translate(-28 261) rotate(270 136.5 22)"
            >
              <text x="248" y="32" style="filter: grayscale(0.9)">🗼</text>
            </g>
            <g class="diag-answer fragment animate-arrow" data-fragment-index="3">
              <g transform="translate(302 265) rotate(0 0 79)">
                <path d="M-0 0 C-1 27, -2 136, -2 163 M3 -4 C3 22, 3 135, 3 162" />
                <path d="M-6 131 C-4 146, -1 157, 5 165 M-6 133 C-3 141, -3 144, 1 160" />
                <path d="M14 132 C8 146, 4 157, 5 165 M14 133 C13 141, 8 144, 1 160" />
              </g>
            </g>
            <g
              class="diag-answer fragment animate-paris-stays-answer"
              data-fragment-index="3"
              transform="translate(78 179) rotate(270 191 22)"
            >
              <text x="0" y="32">Results for Paris</text>
            </g>
            <g
              class="diag-call fragment animate-paris-stays-answer"
              data-fragment-index="3"
              transform="translate(78 179) rotate(270 191 22)"
            >
              <text x="239" y="32" style="filter: grayscale(0.9)">🗼</text>
            </g>
            <g
              class="diag-user fragment animate-london-stays-user"
              data-fragment-index="4"
              transform="translate(261 232) rotate(270 140 22)"
            >
              <text x="0" y="32">User looks for stays in London</text>
            </g>
            <g class="diag-user fragment animate-arrow" data-fragment-index="4">
              <g transform="translate(431 264) rotate(0 -0 80)">
                <path d="M2 2 C2 30, -1 135, -1 162 M2 -2 C1 24, -2 135, -2 163" />
                <path d="M-8 135 C-13 145, -8 151, -3 166 M-11 136 C-10 144, -8 151, -1 162" />
                <path d="M11 135 C2 146, 2 152, -3 166 M9 136 C4 144, 2 151, -1 162" />
              </g>
            </g>
            <g class="diag-call fragment animate-arrow-bottom" data-fragment-index="5">
              <g transform="translate(451 425) rotate(0 -0 -36)">
                <path d="M0 1 C0 -10, 0 -62, 0 -75 M1 -4 C0 -17, -3 -61, -3 -72" />
                <path d="M10 -45 C5 -56, 3 -59, 0 -71 M9 -44 C5 -51, 3 -57, -4 -71" />
                <path d="M-10 -45 C-8 -55, -3 -59, 0 -71 M-10 -43 C-11 -51, -8 -57, -4 -71" />
              </g>
            </g>
            <g
              class="diag-call fragment animate-london-stays-query"
              data-fragment-index="5"
              transform="translate(348 269) rotate(270 126 22)"
            >
              <text x="0" y="32">API call for London 💂‍♂️</text>
            </g>
            <g class="diag-answer fragment animate-arrow" data-fragment-index="6">
              <g transform="translate(652 258) rotate(0 -1 83)">
                <path d="M0 2 C-0 29, -1 138, -2 165 M1 0 C0 27, -4 140, -4 167" />
                <path d="M-11 137 C-7 148, -7 162, -2 168 M-15 138 C-12 147, -10 154, -6 166" />
                <path d="M9 138 C4 149, -2 162, -2 168 M5 139 C1 148, -2 155, -6 166" />
              </g>
            </g>
            <g
              class="diag-answer fragment animate-london-stays-answer"
              data-fragment-index="6"
              transform="translate(439 186) rotate(270 181 22)"
            >
              <text x="0" y="32">Results for London 💂‍♂️</text>
            </g>
            <g class="diag-answer fragment" data-fragment-index="7" transform="translate(78 179) rotate(270 191 22)">
              <text x="0" y="32" style="text-decoration: line-through; fill: #ff1717">Results for Paris</text>
            </g>
            <g class="diag-answer fragment" data-fragment-index="7">
              <g transform="translate(302 265) rotate(0 0 79)">
                <path d="M-0 0 C-1 27, -2 136, -2 163 M3 -4 C3 22, 3 135, 3 162" style="stroke: #ff1717" />
                <path d="M-6 131 C-4 146, -1 157, 5 165 M-6 133 C-3 141, -3 144, 1 160" style="stroke: #ff1717" />
                <path d="M14 132 C8 146, 4 157, 5 165 M14 133 C13 141, 8 144, 1 160" style="stroke: #ff1717" />
              </g>
            </g>
            <g class="diag-answer fragment" data-fragment-index="8" transform="translate(578 179) rotate(270 191 22)">
              <text x="0" y="32">Results for Paris</text>
            </g>
            <g class="diag-call fragment" data-fragment-index="8" transform="translate(578 179) rotate(270 191 22)">
              <text x="239" y="32" style="filter: grayscale(0.9)">🗼</text>
            </g>
            <g class="diag-answer fragment animate-arrow" data-fragment-index="8">
              <g transform="translate(802 265) rotate(0 0 79)">
                <path d="M-0 0 C-1 27, -2 136, -2 163 M3 -4 C3 22, 3 135, 3 162" />
                <path d="M-6 131 C-4 146, -1 157, 5 165 M-6 133 C-3 141, -3 144, 1 160" />
                <path d="M14 132 C8 146, 4 157, 5 165 M14 133 C13 141, 8 144, 1 160" />
              </g>
            </g>
          </svg>
        </section>
        <section>
          <h2>Let's consider a simple example</h2>
          <h3 class="fragment custom-collapse">An autocomplete field in React</h3>
        </section>
        <section>
          <img src="./images/autocomplete-ok.gif" style="border: none; background: none; margin: 0px" />
        </section>
        <section class="fullScreen">
          <pre><code class="hljs" data-trim data-line-numbers="1-27|4,20-23|7,15|8|9-12|13-14|24">
			import React, { useState } from 'react';
			
			export default function Autocomplete({ suggestionsFor }) {
			  const [query, setQuery] = useState('');
			  const [suggestions, setSuggestions] = useState([]);
			  
			  async function updateQuery(newQuery) {
			    setQuery(newQuery);
			    if (newQuery === '') {
			      setSuggestions([]);
			      return;
			    }
			    const suggestions = await suggestionsFor(newQuery);
			    setSuggestions(suggestions);
			  }
			
			  return (
			    &lt;div&gt;
			      &lt;label htmlFor="autocomplete-field"&gt;Select a package: &lt;/label&gt;
			      &lt;input
			        id="autocomplete-field"
			        value={query}
			        onChange={(e) =&gt; updateQuery(e.target.value)} /&gt;
			      &lt;ul&gt;{suggestions.map((s) =&gt; &lt;li key={s}&gt;{s}&lt;/li&gt;)}&lt;/ul&gt;
			    &lt;/div&gt;
			  );
			}			
		  </code></pre>
        </section>
        <section>
          <h3>How to test it?</h3>
        </section>
        <section class="fullScreen">
          <pre><code class="hljs javascript" data-trim data-line-numbers="1,24|2-8|10-17|19-23">
test('should autocomplete queries', async () =&gt; {
  // Arrange
  const allResults = ['apple', 'banana', 'orange', 'pineapple'];
  const suggestionsFor = jest.fn(async (query) =&gt; {
    return allResults.filter((r) =&gt; r.includes(query));
  });
  const userQuery = 'nan';
  const expectedResults = ['banana'];
  
  // Act
  render(&lt;Autocomplete suggestionsFor={suggestionsFor} /&gt;);
  await act(async () =&gt; {
    await userEvent.type(
      screen.getByRole('textbox'),
      userQuery,
      { delay: 1 });
  });
  
  // Assert
  const displayedSuggestions = screen.queryAllByRole('listitem')
      .map((el) =&gt; el.textContent);
  expect(displayedSuggestions).toEqual(expectedResults);
  expect(suggestionsFor).toHaveBeenCalledTimes(userQuery.length);
});
		  </code></pre>
        </section>
        <section>
          <h3>
            Test status: <b><span class="fragment" style="color: green">√</span></b>
          </h3>
          <p class="fragment">🤔 What?</p>
        </section>
        <section>
          <style>
            .current-fragment.animate-search-n-user text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-n-user;
            }
            @keyframes animation-search-n-user {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(90px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(90px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-search-n-query text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-n-query;
            }
            @keyframes animation-search-n-query {
              0% {
                transform: rotate(90deg) scale(2) translateY(-215px) translateX(90px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-215px) translateX(90px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-search-n-answer text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-n-answer;
            }
            @keyframes animation-search-n-answer {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-320px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-320px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-search-na-user text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-na-user;
            }
            @keyframes animation-search-na-user {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(20px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(20px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-search-na-query text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-na-query;
            }
            @keyframes animation-search-na-query {
              0% {
                transform: rotate(90deg) scale(2) translateY(-215px) translateX(20px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-215px) translateX(20px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-search-na-answer text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-na-answer;
            }
            @keyframes animation-search-na-answer {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-130px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-130px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-search-nan-user text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-nan-user;
            }
            @keyframes animation-search-nan-user {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-40px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-40px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-search-nan-query text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-nan-query;
            }
            @keyframes animation-search-nan-query {
              0% {
                transform: rotate(90deg) scale(2) translateY(-215px) translateX(-50px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-215px) translateX(-50px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
            .current-fragment.animate-search-nan-answer text {
              animation-duration: 1500ms;
              animation-iteration-count: 1;
              animation-name: animation-search-nan-answer;
            }
            @keyframes animation-search-nan-answer {
              0% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-210px);
              }
              80% {
                transform: rotate(90deg) scale(2) translateY(-200px) translateX(-210px);
              }
              100% {
                transform: rotate(0deg) scale(1) translateY(0px) translateX(0px);
              }
            }
          </style>
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 926 520">
            <g class="diag-white">
              <g transform="translate(10 436) rotate(0 453 0)">
                <path d="M1 -2 C152 -2, 754 -1, 905 -0 M1 2 C152 3, 752 1, 904 1" />
                <path d="M872 9 C881 11, 895 1, 901 2 M876 12 C885 7, 894 5, 902 1" />
                <path d="M872 -11 C880 -2, 895 -5, 901 2 M876 -7 C885 -5, 894 -0, 902 1" />
              </g>
            </g>
            <g class="diag-white" transform="translate(844 466) rotate(0 34 22)">
              <text x="0" y="32">Time</text>
            </g>
            <g class="diag-user fragment animate-arrow" data-fragment-index="1">
              <g transform="translate(60 265) rotate(0 0 80)">
                <path d="M-1 -1 C-0 25, -0 134, -0 162 M0 -0 C-0 26, 2 133, 1 160" />
                <path d="M-10 133 C-9 138, -1 147, -1 160 M-9 130 C-3 139, -1 147, -0 159" />
                <path d="M10 133 C6 138, 10 147, -1 160 M11 130 C10 138, 6 146, -0 159" />
              </g>
            </g>
            <g
              class="diag-user fragment animate-search-n-user"
              data-fragment-index="1"
              transform="translate(-118 217) rotate(270 150 22)"
            >
              <text x="0" y="32">Updating query to "n"</text>
            </g>
            <g class="diag-call fragment animate-arrow-bottom" data-fragment-index="2">
              <g transform="translate(83 426.148936170213) rotate(0 -1 -39)">
                <path d="M-1 -0 C-2 -13, -0 -62, -0 -74 M-2 -2 C-3 -15, 0 -64, 0 -77" />
                <path d="M7 -50 C6 -60, 2 -70, 2 -80 M8 -50 C6 -56, 6 -60, 1 -76" />
                <path d="M-12 -51 C-5 -61, -1 -70.551366474985, 2 -80 M-11 -51 C-8 -56, -3 -61, 1 -76" />
              </g>
            </g>
            <g
              class="diag-call fragment animate-search-n-query"
              data-fragment-index="2"
              transform="translate(-28 261) rotate(270 136.5 22)"
            >
              <text x="0" y="32">API call for "n"</text>
            </g>
            <g
              class="diag-user fragment animate-search-na-user"
              data-fragment-index="3"
              transform="translate(12 232) rotate(270 140 22)"
            >
              <text x="0" y="32">Updating query to "na"</text>
            </g>
            <g class="diag-user fragment animate-arrow" data-fragment-index="3">
              <g transform="translate(190 264) rotate(0 -0 80)">
                <path d="M2 2 C2 30, -1 135, -1 162 M2 -2 C1 24, -2 135, -2 163" />
                <path d="M-8 135 C-13 145, -8 151, -3 166 M-11 136 C-10 144, -8 151, -1 162" />
                <path d="M11 135 C2 146, 2 152, -3 166 M9 136 C4 144, 2 151, -1 162" />
              </g>
            </g>
            <g class="diag-call fragment animate-arrow-bottom" data-fragment-index="4">
              <g transform="translate(213 426.148936170213) rotate(0 -1 -39)">
                <path d="M-1 -0 C-2 -13, -0 -62, -0 -74 M-2 -2 C-3 -15, 0 -64, 0 -77" />
                <path d="M7 -50 C6 -60, 2 -70, 2 -80 M8 -50 C6 -56, 6 -60, 1 -76" />
                <path d="M-12 -51 C-5 -61, -1 -70.551366474985, 2 -80 M-11 -51 C-8 -56, -3 -61, 1 -76" />
              </g>
            </g>
            <g
              class="diag-call fragment animate-search-na-query"
              data-fragment-index="4"
              transform="translate(102 261) rotate(270 136.5 22)"
            >
              <text x="0" y="32">API call for "na"</text>
            </g>
            <g
              class="diag-user fragment animate-search-nan-user"
              data-fragment-index="5"
              transform="translate(141 232) rotate(270 140 22)"
            >
              <text x="0" y="32">Updating query to "nan"</text>
            </g>
            <g class="diag-user fragment animate-arrow" data-fragment-index="5">
              <g transform="translate(311 264) rotate(0 -0 80)">
                <path d="M2 2 C2 30, -1 135, -1 162 M2 -2 C1 24, -2 135, -2 163" />
                <path d="M-8 135 C-13 145, -8 151, -3 166 M-11 136 C-10 144, -8 151, -1 162" />
                <path d="M11 135 C2 146, 2 152, -3 166 M9 136 C4 144, 2 151, -1 162" />
              </g>
            </g>
            <g class="diag-call fragment animate-arrow-bottom" data-fragment-index="6">
              <g transform="translate(331 425) rotate(0 -0 -36)">
                <path d="M0 1 C0 -10, 0 -62, 0 -75 M1 -4 C0 -17, -3 -61, -3 -72" />
                <path d="M10 -45 C5 -56, 3 -59, 0 -71 M9 -44 C5 -51, 3 -57, -4 -71" />
                <path d="M-10 -45 C-8 -55, -3 -59, 0 -71 M-10 -43 C-11 -51, -8 -57, -4 -71" />
              </g>
            </g>
            <g
              class="diag-call fragment animate-search-nan-query"
              data-fragment-index="6"
              transform="translate(228 269) rotate(270 126 22)"
            >
              <text x="0" y="32">API call for "nan"</text>
            </g>
            <g class="diag-answer fragment animate-arrow" data-fragment-index="7">
              <g transform="translate(502 265) rotate(0 0 79)">
                <path d="M-0 0 C-1 27, -2 136, -2 163 M3 -4 C3 22, 3 135, 3 162" />
                <path d="M-6 131 C-4 146, -1 157, 5 165 M-6 133 C-3 141, -3 144, 1 160" />
                <path d="M14 132 C8 146, 4 157, 5 165 M14 133 C13 141, 8 144, 1 160" />
              </g>
            </g>
            <g
              class="diag-answer fragment animate-search-na-answer"
              data-fragment-index="7"
              transform="translate(278 179) rotate(270 191 22)"
            >
              <text x="0" y="32">Results for "na" [🍌]</text>
            </g>
            <g class="diag-answer fragment animate-arrow" data-fragment-index="8">
              <g transform="translate(652 258) rotate(0 -1 83)">
                <path d="M0 2 C-0 29, -1 138, -2 165 M1 0 C0 27, -4 140, -4 167" />
                <path d="M-11 137 C-7 148, -7 162, -2 168 M-15 138 C-12 147, -10 154, -6 166" />
                <path d="M9 138 C4 149, -2 162, -2 168 M5 139 C1 148, -2 155, -6 166" />
              </g>
            </g>
            <g
              class="diag-answer fragment animate-search-nan-answer"
              data-fragment-index="8"
              transform="translate(439 186) rotate(270 181 22)"
            >
              <text x="0" y="32">Results for "nan" [🍌]</text>
            </g>
            <g class="diag-answer fragment animate-arrow" data-fragment-index="9">
              <g transform="translate(802 258) rotate(0 -1 83)">
                <path d="M0 2 C-0 29, -1 138, -2 165 M1 0 C0 27, -4 140, -4 167" />
                <path d="M-11 137 C-7 148, -7 162, -2 168 M-15 138 C-12 147, -10 154, -6 166" />
                <path d="M9 138 C4 149, -2 162, -2 168 M5 139 C1 148, -2 155, -6 166" />
              </g>
            </g>
            <g
              class="diag-answer fragment animate-search-n-answer"
              data-fragment-index="9"
              transform="translate(589 186) rotate(270 181 22)"
            >
              <text x="0" y="32">Results for "n" [🍌/🍊/🍍]</text>
            </g>
          </svg>
        </section>
        <section>
          <img src="./images/autocomplete-bug-screenshot.png" style="border: none; background: none; margin: 0px" />
        </section>
        <section>
          <img src="./images/autocomplete-bug.gif" style="border: none; background: none; margin: 0px" />
        </section>
        <section>
          <h3>What is missing in our test?</h3>
        </section>
        <section>
          <style>
            section.present .results-n {
              stroke: red;
              fill: red;
              animation-delay: 5s;
              animation-duration: 8s;
              animation-iteration-count: infinite;
              animation-name: results-n-anim;
            }
            section.present .results-n path {
              stroke-width: 4px;
              fill: none;
            }
            section.present .results-n text {
              font-family: 'Virgil';
              font-size: 26px;
              stroke-width: 0px;
            }
            section.present .results-na {
              animation-delay: 5s;
              animation-duration: 8s;
              animation-iteration-count: infinite;
              animation-name: results-na-anim;
            }
            section.present .results-nan {
              animation-delay: 5s;
              animation-duration: 8s;
              animation-iteration-count: infinite;
              animation-name: results-nan-anim;
            }
            /* tx 150px */
            @keyframes results-n-anim {
              0% {
                fill: #ff1717;
                stroke: #ff1717;
                transform: translateX(0px);
              }
              25% {
                fill: #17ff2e;
                stroke: #17ff2e;
                transform: translateX(-300px);
              }
              50% {
                fill: #17ff2e;
                stroke: #17ff2e;
                transform: translateX(-150px);
              }
              75% {
                fill: #17ff2e;
                stroke: #17ff2e;
                transform: translateX(-300px);
              }
              100% {
                fill: #ff1717;
                stroke: #ff1717;
                transform: translateX(0px);
              }
            }
            @keyframes results-na-anim {
              0% {
                transform: translateX(0px);
              }
              25% {
                transform: translateX(150px);
              }
              50% {
                transform: translateX(300px);
              }
              75% {
                transform: translateX(300px);
              }
              100% {
                transform: translateX(0px);
              }
            }
            @keyframes results-nan-anim {
              0% {
                transform: translateX(0px);
              }
              25% {
                transform: translateX(150px);
              }
              50% {
                transform: translateX(-150px);
              }
              75% {
                transform: translateX(0px);
              }
              100% {
                transform: translateX(0px);
              }
            }
          </style>
          <svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 926 520">
            <g class="diag-white">
              <g transform="translate(10 436) rotate(0 453 0)">
                <path d="M1 -2 C152 -2, 754 -1, 905 -0 M1 2 C152 3, 752 1, 904 1" />
                <path d="M872 9 C881 11, 895 1, 901 2 M876 12 C885 7, 894 5, 902 1" />
                <path d="M872 -11 C880 -2, 895 -5, 901 2 M876 -7 C885 -5, 894 -0, 902 1" />
              </g>
            </g>
            <g class="diag-white" transform="translate(844 466) rotate(0 34 22)">
              <text x="0" y="32">Time</text>
            </g>
            <g class="diag-user">
              <g transform="translate(60 265) rotate(0 0 80)">
                <path d="M-1 -1 C-0 25, -0 134, -0 162 M0 -0 C-0 26, 2 133, 1 160" />
                <path d="M-10 133 C-9 138, -1 147, -1 160 M-9 130 C-3 139, -1 147, -0 159" />
                <path d="M10 133 C6 138, 10 147, -1 160 M11 130 C10 138, 6 146, -0 159" />
              </g>
            </g>
            <g class="diag-user" transform="translate(-118 217) rotate(270 150 22)">
              <text x="0" y="32">Updating query to "n"</text>
            </g>
            <g class="diag-call">
              <g transform="translate(83 426.148936170213) rotate(0 -1 -39)">
                <path d="M-1 -0 C-2 -13, -0 -62, -0 -74 M-2 -2 C-3 -15, 0 -64, 0 -77" />
                <path d="M7 -50 C6 -60, 2 -70, 2 -80 M8 -50 C6 -56, 6 -60, 1 -76" />
                <path d="M-12 -51 C-5 -61, -1 -70.551366474985, 2 -80 M-11 -51 C-8 -56, -3 -61, 1 -76" />
              </g>
            </g>
            <g class="diag-call" transform="translate(-28 261) rotate(270 136.5 22)">
              <text x="0" y="32">API call for "n"</text>
            </g>
            <g class="diag-user" transform="translate(12 232) rotate(270 140 22)">
              <text x="0" y="32">Updating query to "na"</text>
            </g>
            <g class="diag-user">
              <g transform="translate(190 264) rotate(0 -0 80)">
                <path d="M2 2 C2 30, -1 135, -1 162 M2 -2 C1 24, -2 135, -2 163" />
                <path d="M-8 135 C-13 145, -8 151, -3 166 M-11 136 C-10 144, -8 151, -1 162" />
                <path d="M11 135 C2 146, 2 152, -3 166 M9 136 C4 144, 2 151, -1 162" />
              </g>
            </g>
            <g class="diag-call">
              <g transform="translate(213 426.148936170213) rotate(0 -1 -39)">
                <path d="M-1 -0 C-2 -13, -0 -62, -0 -74 M-2 -2 C-3 -15, 0 -64, 0 -77" />
                <path d="M7 -50 C6 -60, 2 -70, 2 -80 M8 -50 C6 -56, 6 -60, 1 -76" />
                <path d="M-12 -51 C-5 -61, -1 -70.551366474985, 2 -80 M-11 -51 C-8 -56, -3 -61, 1 -76" />
              </g>
            </g>
            <g class="diag-call" transform="translate(102 261) rotate(270 136.5 22)">
              <text x="0" y="32">API call for "na"</text>
            </g>
            <g class="diag-user" transform="translate(141 232) rotate(270 140 22)">
              <text x="0" y="32">Updating query to "nan"</text>
            </g>
            <g class="diag-user">
              <g transform="translate(311 264) rotate(0 -0 80)">
                <path d="M2 2 C2 30, -1 135, -1 162 M2 -2 C1 24, -2 135, -2 163" />
                <path d="M-8 135 C-13 145, -8 151, -3 166 M-11 136 C-10 144, -8 151, -1 162" />
                <path d="M11 135 C2 146, 2 152, -3 166 M9 136 C4 144, 2 151, -1 162" />
              </g>
            </g>
            <g class="diag-call">
              <g transform="translate(331 425) rotate(0 -0 -36)">
                <path d="M0 1 C0 -10, 0 -62, 0 -75 M1 -4 C0 -17, -3 -61, -3 -72" />
                <path d="M10 -45 C5 -56, 3 -59, 0 -71 M9 -44 C5 -51, 3 -57, -4 -71" />
                <path d="M-10 -45 C-8 -55, -3 -59, 0 -71 M-10 -43 C-11 -51, -8 -57, -4 -71" />
              </g>
            </g>
            <g class="diag-call" transform="translate(228 269) rotate(270 126 22)">
              <text x="0" y="32">API call for "nan"</text>
            </g>
            <g class="diag-answer results-na">
              <g transform="translate(502 265) rotate(0 0 79)">
                <path d="M-0 0 C-1 27, -2 136, -2 163 M3 -4 C3 22, 3 135, 3 162" />
                <path d="M-6 131 C-4 146, -1 157, 5 165 M-6 133 C-3 141, -3 144, 1 160" />
                <path d="M14 132 C8 146, 4 157, 5 165 M14 133 C13 141, 8 144, 1 160" />
              </g>
            </g>
            <g class="diag-answer results-na">
              <text x="0" y="32" transform="translate(278 179) rotate(270 191 22)">Results for "na" [🍌]</text>
            </g>
            <g class="diag-answer results-nan">
              <g transform="translate(652 258) rotate(0 -1 83)">
                <path d="M0 2 C-0 29, -1 138, -2 165 M1 0 C0 27, -4 140, -4 167" />
                <path d="M-11 137 C-7 148, -7 162, -2 168 M-15 138 C-12 147, -10 154, -6 166" />
                <path d="M9 138 C4 149, -2 162, -2 168 M5 139 C1 148, -2 155, -6 166" />
              </g>
            </g>
            <g class="diag-answer results-nan">
              <text x="0" y="32" transform="translate(439 186) rotate(270 181 22)">Results for "nan" [🍌]</text>
            </g>
            <g class="results-n">
              <g transform="translate(802 258) rotate(0 -1 83)">
                <path d="M0 2 C-0 29, -1 138, -2 165 M1 0 C0 27, -4 140, -4 167" />
                <path d="M-11 137 C-7 148, -7 162, -2 168 M-15 138 C-12 147, -10 154, -6 166" />
                <path d="M9 138 C4 149, -2 162, -2 168 M5 139 C1 148, -2 155, -6 166" />
              </g>
            </g>
            <g class="results-n">
              <text x="0" y="32" transform="translate(589 186) rotate(270 181 22)">Results for "n" [🍌/🍊/🍍]</text>
            </g>
          </svg>
        </section>
        <section data-background="#282ea9">
          <h3>Let's test it using <code>fast-check</code></h3>
          <img
            src="./images/Screenshot 2023-02-22 000716.png"
            style="border: none; background: none; margin: 0px; box-shadow: none"
          />
          <p class="vsmallnote">
            Source:
            <a href="https://fast-check.dev/" target="_blank">https://fast-check.dev/</a>
          </p>
        </section>
        <section class="fullScreen hidebefore">
          <style>
            section.hidebefore code {
              overflow-x: hidden;
            }
            section.hidebefore code[data-line-numbers='1-29'] tr:nth-child(2) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='1-29'] tr:nth-child(3) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='1-29'] tr:nth-child(7) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='1-29'] tr:nth-child(9) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='1-29'] tr:nth-child(20) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='1-29'] tr:nth-child(27) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='1-29'] tr:nth-child(28) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='2,3,27,28'] tr:nth-child(7) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='2,3,27,28'] tr:nth-child(9) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='2,3,27,28'] tr:nth-child(20) td.hljs-ln-code,
            section.hidebefore code[data-line-numbers='7-9'] tr:nth-child(20) td.hljs-ln-code {
              opacity: 0 !important;
            }
            section.hidebefore code.visible[data-line-numbers='2,3,27,28'] tr:nth-child(2) td.hljs-ln-code,
            section.hidebefore code.visible[data-line-numbers='2,3,27,28'] tr:nth-child(3) td.hljs-ln-code,
            section.hidebefore code.visible[data-line-numbers='2,3,27,28'] tr:nth-child(27) td.hljs-ln-code,
            section.hidebefore code.visible[data-line-numbers='2,3,27,28'] tr:nth-child(28) td.hljs-ln-code,
            section.hidebefore code.visible[data-line-numbers='7-9'] tr:nth-child(7) td.hljs-ln-code,
            section.hidebefore code.visible[data-line-numbers='7-9'] tr:nth-child(9) td.hljs-ln-code,
            section.hidebefore code.visible[data-line-numbers='20'] tr:nth-child(20) td.hljs-ln-code {
              animation-duration: 500ms;
              animation-name: show-code-line;
              animation-timing-function: ease-in-out;
            }
            @keyframes show-code-line {
              from {
                transform: translateX(200%);
              }
              to {
                transform: translateX(0%);
              }
            }
          </style>
          <pre><code class="hljs javascript" data-trim data-line-numbers="1-29|2,3,27,28|7-9|20|2,3,27,28,7-9,20">
test('should autocomplete queries', async () =&gt; {
  await fc.assert(
    fc.asyncProperty(fc.scheduler({ act }), async (s) =&gt; {
      // Arrange
      const allResults = ['apple', 'banana', 'orange', 'pineapple'];
      const suggestionsFor = jest.fn(
        s.scheduleFunction(
          async query =&gt; allResults.filter((r) =&gt; r.includes(query))
        )
      );
      const userQuery = 'nan';
      const expectedResults = ['banana'];
      
      // Act
      render(&lt;Autocomplete suggestionsFor={suggestionsFor} /&gt;);
      await act(async () =&gt; {
        await userEvent.type(screen.getByRole('textbox'),
          userQuery, { delay: 1 });
      });
      await s.waitAll();
      
      // Assert
      const displayedSuggestions = screen.queryAllByRole('listitem')
          .map((el) =&gt; el.textContent);
      expect(displayedSuggestions).toEqual(expectedResults);
      expect(suggestionsFor).toHaveBeenCalledTimes(userQuery.length);
    }).beforeEach(cleanup)
  );
});
			</code></pre>
        </section>
        <section>
          <h3>
            Test status: <b><span class="fragment" style="color: red">×</span></b>
          </h3>
        </section>
        <section class="fullScreen">
          <pre><code class="hljs text" data-trim data-line-numbers="1-25|3-14|11,12|8,9|5,6|5-12|18-25">
Property failed after 3 tests
{ seed: 1134225087, path: "2", endOnFailure: true }
Counterexample: [Scheduler`

-> [task#3] function::("nan")
	resolved with value ["banana"]

-> [task#2] function::("na")
	resolved with value ["banana"]

-> [task#1] function::("n")
	resolved with value ["banana","orange","pineapple"]

`]
Shrunk 0 time(s)
Got error: Error: expect(received).toEqual(expected) // deep equality

- Expected
+ Received

  Array [
      "banana",
+     "orange",
+     "pineapple",
  ]
			</code></pre>
        </section>
        <section class="fullScreen" data-transition="slide-in fade-out">
          <pre><code class="hljs javascript" data-trim data-line-numbers="1-29|12">
test('should autocomplete queries', async () =&gt; {
  await fc.assert(
    fc.asyncProperty(fc.scheduler({ act }), async (s) =&gt; {
      // Arrange
      const allResults = ['apple', 'banana', 'orange', 'pineapple'];
      const suggestionsFor = jest.fn(
        s.scheduleFunction(async (query) =&gt; {
          return allResults.filter((r) =&gt; r.includes(query));
        })
      );
      const userQuery = 'nan';
      const expectedResults = ['banana'];
      
      // Act
      render(&lt;Autocomplete suggestionsFor={suggestionsFor} /&gt;);
      await act(async () =&gt; {
        await userEvent.type(screen.getByRole('textbox'),
          userQuery, { delay: 1 });
      });
      await s.waitAll();
      
      // Assert
      const displayedSuggestions = screen.queryAllByRole('listitem')
          .map((el) =&gt; el.textContent);
      expect(displayedSuggestions).toEqual(expectedResults);
      expect(suggestionsFor).toHaveBeenCalledTimes(userQuery.length);
    }).beforeEach(cleanup)
  );
});
			</code></pre>
        </section>
        <section class="fullScreen" data-transition="fade-in fade-out">
          <pre><code class="hljs javascript" data-trim data-line-numbers="12,13|11">
test('should autocomplete queries', async () =&gt; {
  await fc.assert(
    fc.asyncProperty(fc.scheduler({ act }), async (s) =&gt; {
      // Arrange
      const allResults = ['apple', 'banana', 'orange', 'pineapple'];
      const suggestionsFor = jest.fn(
        s.scheduleFunction(async (query) =&gt; {
          return allResults.filter((r) =&gt; r.includes(query));
        })
      );
      const userQuery = 'nan';
      const expectedResults = allResults
          .filter((r) =&gt; r.includes(userQuery));
      
      // Act
      render(&lt;Autocomplete suggestionsFor={suggestionsFor} /&gt;);
      await act(async () =&gt; {
        await userEvent.type(screen.getByRole('textbox'),
          userQuery, { delay: 1 });
      });
      await s.waitAll();
      
      // Assert
      const displayedSuggestions = screen.queryAllByRole('listitem')
          .map((el) =&gt; el.textContent);
      expect(displayedSuggestions).toEqual(expectedResults);
      expect(suggestionsFor).toHaveBeenCalledTimes(userQuery.length);
    }).beforeEach(cleanup)
  );
});
			</code></pre>
        </section>
        <section class="fullScreen" data-transition="fade-in fade-out">
          <pre><code class="hljs javascript" data-trim data-line-numbers="4,5|7">
test('should autocomplete queries', async () =&gt; {
  await fc.assert(
    fc.asyncProperty(fc.scheduler({ act })
                   , fc.string({ minLength: 1 })
                   , async (s, userQuery) =&gt; {
      // Arrange
      const allResults = ['apple', 'banana', 'orange', 'pineapple'];
      const suggestionsFor = jest.fn(
        s.scheduleFunction(async (query) =&gt; {
          return allResults.filter((r) =&gt; r.includes(query));
        })
      );
      const expectedResults = allResults
          .filter((r) =&gt; r.includes(userQuery));
      
      // Act
      render(&lt;Autocomplete suggestionsFor={suggestionsFor} /&gt;);
      await act(async () =&gt; {
        await userEvent.type(screen.getByRole('textbox'),
          userQuery, { delay: 1 });
      });
      await s.waitAll();
      
      // Assert
      const displayedSuggestions = screen.queryAllByRole('listitem')
          .map((el) =&gt; el.textContent);
      expect(displayedSuggestions).toEqual(expectedResults);
      expect(suggestionsFor).toHaveBeenCalledTimes(userQuery.length);
    }).beforeEach(cleanup)
  );
});
			</code></pre>
        </section>
        <section class="fullScreen" data-transition="fade-in fade-out">
          <pre><code class="hljs javascript" data-trim data-line-numbers="4,6|18-21">
test('should autocomplete queries', async () =&gt; {
  await fc.assert(
	fc.asyncProperty(fc.scheduler({ act })
                   , fc.uniqueArray(fc.string())
                   , fc.string({ minLength: 1 })
                   , async (s, allResults, userQuery) =&gt; {
      // Arrange
      const suggestionsFor = jest.fn(
        s.scheduleFunction(async (query) =&gt; {
          return allResults.filter((r) =&gt; r.includes(query));
        })
      );
      const expectedResults = allResults
          .filter((r) =&gt; r.includes(userQuery));
      
      // Act
      render(&lt;Autocomplete suggestionsFor={suggestionsFor} /&gt;);
      await act(async () =&gt; {
        await userEvent.type(screen.getByRole('textbox'),
          userQuery, { delay: 1 });
      });
      await s.waitAll();
      
      // Assert
      const displayedSuggestions = screen.queryAllByRole('listitem')
          .map((el) =&gt; el.textContent);
      expect(displayedSuggestions).toEqual(expectedResults);
      expect(suggestionsFor).toHaveBeenCalledTimes(userQuery.length);
    }).beforeEach(cleanup)
  );
});
			</code></pre>
        </section>
        <section class="fullScreen" data-transition="fade-in slide-out">
          <pre><code class="hljs javascript" data-trim data-line-numbers="18-25|1-200">
test('should autocomplete queries', async () =&gt; {
  await fc.assert(
	fc.asyncProperty(fc.scheduler({ act })
                   , fc.uniqueArray(fc.string())
                   , fc.string({ minLength: 1 })
                   , async (s, allResults, userQuery) =&gt; {
      // Arrange
      const suggestionsFor = jest.fn(
        s.scheduleFunction(async (query) =&gt; {
          return allResults.filter((r) =&gt; r.includes(query));
        })
      );
      const expectedResults = allResults
          .filter((r) =&gt; r.includes(userQuery));
      
      // Act
      render(&lt;Autocomplete suggestionsFor={suggestionsFor} /&gt;);
      s.scheduleSequence(
        [...userQuery].map(character =&gt; ({
          label: `Typing "${character}"`,
          builder: () =&gt; userEvent.type(
                                screen.getByRole('textbox'),
                                character),
        }))
      );
      await s.waitAll();
      
      // Assert
      const displayedSuggestions = queryAllByRole('listitem')
          .map((el) =&gt; el.textContent);
      expect(displayedSuggestions).toEqual(expectedResults);
      expect(suggestionsFor).toHaveBeenCalledTimes(userQuery.length);
    }).beforeEach(cleanup)
  );
});
			</code></pre>
        </section>
        <section class="fullScreen">
          <pre><code class="hljs text" data-trim>
Property failed after 2 tests
{ seed: -1614603237, path: "1:[...]:2", endOnFailure: true }

Counterexample: [
  Scheduler`
    -> [task#1] sequence::Typing "A" resolved
    -> [task#3] sequence::Typing "B" resolved
    -> [task#4] function::("AB") resolved with value []
    -> [task#2] function::("A") resolved with value ["A"]
  `,["A"],"AB"]

Shrunk 15 time(s)
Got error: Error: expect(received).toEqual(expected) // deep equality

- Expected
+ Received

- Array []
+ Array [
+   "A",
+ ]
			</code></pre>
        </section>
        <section data-background="#ffffff">
          <div style="width: 100%; height: 100%; display: grid">
            <div
              style="
                grid-row: 1;
                grid-column: 1;
                width: 100%;
                height: 100%;
                display: flex;
                justify-content: center;
                align-items: center;
                opacity: 0.2;
              "
            >
              <img src="./images/table.png" style="border: none; background: none; margin: 0px; box-shadow: none" />
            </div>
            <div
              style="
                grid-row: 1;
                grid-column: 1;
                width: 100%;
                height: 100%;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
              "
            >
              <p class="fragment">Race conditions may break users' trust</p>
              <p class="fragment">Reordering is the key</p>
              <p class="fragment">Randomized way can go further</p>
            </div>
          </div>
        </section>
        <section>
          <h2>Questions?</h2>
          <div style="margin-top: 48px"></div>
          <div>
            <img src="./images/logo.png" style="border: none; background: none; margin: 0px; box-shadow: none" />
            <p
              class="fragment custom-collapse"
              style="
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 0.8em;
                opacity: 0.9;
                margin-top: -16px;
              "
            >
              <span style="margin-right: 8px">Used by </span>
              <img src="./images/jest.svg" style="height: 20px; border: none; background: none; margin: 0px" />
              <span style="margin: 0 8px"> and </span>
              <img src="./images/jasmine.svg" style="height: 20px; border: none; background: none; margin: 0px" />
            </p>
            <p
              class="fragment custom-collapse"
              style="
                display: flex;
                justify-content: center;
                align-items: center;
                font-size: 0.8em;
                opacity: 0.9;
                margin-top: -24px;
              "
            >
              <span style="margin-right: 8px">Found bugs in </span>
              <img src="./images/jest.svg" style="height: 20px; border: none; background: none; margin: 0px" />
              <span style="margin: 0 8px">, </span>
              <img src="./images/jasmine.svg" style="height: 20px; border: none; background: none; margin: 0px" />
              <span style="margin: 0 8px">, </span>
              <img src="./images/react.svg" style="height: 20px; border: none; background: none; margin: 0px" />
              <span style="margin: 0 8px">…</span>
            </p>
          </div>
          <div style="margin-top: 48px"></div>
          <div style="color: #ffffff; vertical-align: middle">
            <img src="./images/github-white.png" style="height: 32px; border: none; background: none; margin: 0px" />
            dubzzz
          </div>
          <div style="color: #4293db; vertical-align: middle">
            <img
              src="./images/Mastodon_Logotype_(Simple).svg.png"
              style="height: 32px; border: none; background: none; margin: 0px"
            />
            ndubien
          </div>
        </section>
      </div>
    </div>
    <div
      id="social-footer"
      style="
        display: grid;
        align-items: center;
        column-gap: 0.5rem;
        row-gap: 0.2rem;
        position: fixed;
        z-index: 9999;
        left: 1em;
        bottom: 1em;
        color: #ffffff;
        font-size: 2rem;
        font-family: 'Source Sans Pro', Helvetica, sans-serif;
      "
    >
      <img
        src="./images/github-white.png"
        class="footer-github"
        style="
          justify-self: center;
          grid-row: 1;
          grid-column: 1;
          height: 2rem;
          border: none;
          background: none;
          margin: 0px;
          text-shadow: #0007 1px 1px 1px;
        "
      />
      <div
        style="
          grid-row: 1;
          grid-column: 2;
          color: #ffffff;
          vertical-align: middle;
          text-shadow: #0007 1px 1px 1px;
          font-family: MonospaceKrypton;
        "
      >
        dubzzz
      </div>
      <img
        src="./images/Mastodon_Logotype_(Simple).svg.png"
        style="
          justify-self: center;
          grid-row: 2;
          grid-column: 1;
          height: 2rem;
          border: none;
          background: none;
          margin: 0px;
        "
      />
      <div style="grid-row: 2; grid-column: 2; color: #4293db; vertical-align: middle; font-family: MonospaceKrypton">
        ndubien
      </div>
      <img
        src="./images/npm.png"
        style="
          justify-self: center;
          grid-row: 3;
          grid-column: 1;
          width: 2rem;
          border: none;
          background: none;
          margin: 0px;
        "
      />
      <div style="grid-row: 3; grid-column: 2; color: #cb3837; vertical-align: middle; font-family: MonospaceKrypton">
        fast-check
      </div>
    </div>

    <script src="js/reveal.js"></script>

    <script>
      // More info about config & dependencies:
      // - https://github.com/hakimel/reveal.js#configuration
      // - https://github.com/hakimel/reveal.js#dependencies
      Reveal.initialize({
        hash: true,
        slideNumber: true,
        fragmentInURL: true,
        totalTime: 20 * 60,
        dependencies: [
          { src: 'plugin/markdown/marked.js' },
          { src: 'plugin/markdown/markdown.js' },
          { src: 'plugin/highlight/highlight.js' },
          { src: 'plugin/notes/notes.js', async: true },
        ],
      });
      const bsodSound = new Audio('images/bsod.mp3');
      Reveal.addEventListener('bsod-slide', () => {
        document.getElementById('social-footer').style.opacity = '0';
        document.getElementsByClassName('progress')[0].style.opacity = '0';
        document.getElementsByClassName('controls')[0].style.opacity = '0';
        document.getElementsByClassName('slide-number')[0].style.opacity = '0';
        bsodSound.play();
      });
      Reveal.addEventListener('bsod-slide-before', () => {
        document.getElementById('social-footer').style.opacity = '1';
        document.getElementsByClassName('progress')[0].style.opacity = '1';
        document.getElementsByClassName('controls')[0].style.opacity = '1';
        document.getElementsByClassName('slide-number')[0].style.opacity = '1';
      });
      Reveal.addEventListener('bsod-slide-after', () => {
        document.getElementById('social-footer').style.opacity = '1';
        document.getElementsByClassName('progress')[0].style.opacity = '1';
        document.getElementsByClassName('controls')[0].style.opacity = '1';
        document.getElementsByClassName('slide-number')[0].style.opacity = '1';
      });

      // Taken from https://developer.mozilla.org/en-US/docs/Web/Events/wheel
      // creates a global "addWheelListener" method
      // example: addWheelListener( elem, function( e ) { console.log( e.deltaY ); e.preventDefault(); } );
      (function (window, document) {
        var prefix = '',
          _addEventListener,
          support;

        // detect event model
        if (window.addEventListener) {
          _addEventListener = 'addEventListener';
        } else {
          _addEventListener = 'attachEvent';
          prefix = 'on';
        }

        // detect available wheel event
        support =
          'onwheel' in document.createElement('div')
            ? 'wheel' // Modern browsers support "wheel"
            : document.onmousewheel !== undefined
            ? 'mousewheel' // Webkit and IE support at least "mousewheel"
            : 'DOMMouseScroll'; // let's assume that remaining browsers are older Firefox

        window.addWheelListener = function (elem, callback, useCapture) {
          _addWheelListener(elem, support, callback, useCapture);

          // handle MozMousePixelScroll in older Firefox
          if (support == 'DOMMouseScroll') {
            _addWheelListener(elem, 'MozMousePixelScroll', callback, useCapture);
          }
        };

        function _addWheelListener(elem, eventName, callback, useCapture) {
          elem[_addEventListener](
            prefix + eventName,
            support == 'wheel'
              ? callback
              : function (originalEvent) {
                  !originalEvent && (originalEvent = window.event);

                  // create a normalized event object
                  var event = {
                    // keep a ref to the original event object
                    originalEvent: originalEvent,
                    target: originalEvent.target || originalEvent.srcElement,
                    type: 'wheel',
                    deltaMode: originalEvent.type == 'MozMousePixelScroll' ? 0 : 1,
                    deltaX: 0,
                    deltaY: 0,
                    deltaZ: 0,
                    preventDefault: function () {
                      originalEvent.preventDefault
                        ? originalEvent.preventDefault()
                        : (originalEvent.returnValue = false);
                    },
                  };

                  // calculate deltaY (and deltaX) according to the event
                  if (support == 'mousewheel') {
                    event.deltaY = (-1 / 40) * originalEvent.wheelDelta;
                    // Webkit also support wheelDeltaX
                    originalEvent.wheelDeltaX && (event.deltaX = (-1 / 40) * originalEvent.wheelDeltaX);
                  } else {
                    event.deltaY = originalEvent.deltaY || originalEvent.detail;
                  }

                  // it's time to fire the callback
                  return callback(event);
                },
            useCapture || false
          );
        }
      })(window, document);

      window.addWheelListener(document, function (event) {
        console.log(JSON.stringify(event.deltaY));
        if (event.deltaY > 0) {
          document.dispatchEvent(new KeyboardEvent('keydown', { keyCode: 32, which: 32 }));
        } else if (event.deltaY < 0) {
          document.dispatchEvent(new KeyboardEvent('keydown', { keyCode: 33, which: 33 }));
        }
      });

      let laserEnabled = false;
      function laserPtr() {
        if (laserEnabled) return;
        laserEnabled = true;
        Reveal.removeEventListeners();
        window.addEventListener('keydown', (event) => {
          if (event.keyCode === 37 || event.keyCode === 38) Reveal.navigatePrev();
          if (event.keyCode === 39 || event.keyCode === 40) Reveal.navigateNext();
          if (event.keyCode === 82) ElapsedTimeBar.reset();
        });
      }
      let code = '';
      const laserCode = '!!!!!';
      window.addEventListener('keydown', (event) => {
        code += event.key;
        if (code.length > laserCode.length) code = code.substr(code.length - laserCode.length);
        if (code === laserCode) laserPtr();
      });
    </script>
  </body>
</html>
